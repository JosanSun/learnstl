<!doctype html>
<html lang="zh" class=""><head><meta charset="utf-8"/><title data-react-helmet="true">【游戏框架系列】用C++画光（二）——矩形</title><meta name="renderer" content="webkit"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="force-rendering" content="webkit"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"/><link rel="shortcut icon" href="https://static.zhihu.com/static/favicon.ico" type="image/x-icon"/><link href="//static.zhihu.com/hemingway/app.72f7034426788143201440249cd536a8.css" rel="stylesheet"/><style></style></head><body><div id="react-root"><div><div class="Layout av-cardBackground" data-zop-userToken="{&quot;userToken&quot;:&quot;&quot;}"><div class="Layout-navbarHolder"><header class="Navbar"><div class="Navbar-logo-wrapper"><a class="Navbar-logo icon-ic_zhihu_logo" href="//www.zhihu.com" target="_blank" rel="noopener noreferrer" aria-label="知乎首页"></a></div><div class="Navbar-postTitle Navbar-title"><a href="https://zhuanlan.zhihu.com/learncpp"><img class="Navbar-columnIcon" alt="学习C++" src="https://pic4.zhimg.com/v2-bf63794c542fc73b11e17014b7e0d01d_m.jpg"/></a><div class="Navbar-postTitleName"><span class="Navbar-postTitleMeta">首发于</span><a class="Navbar-postTitleMain" href="https://zhuanlan.zhihu.com/learncpp">学习C++</a></div></div><div class="Navbar-functionality"><a class="Navbar-write"><i class="icon icon-ic_nav_new"></i>写文章</a><button class="Button Navbar-loginButon Button--blue" type="button">登录</button></div></header></div><div></div><div class="Layout-main av-card av-paddingBottom av-bodyFont Layout-titleImage--normal"><div class="PostIndex-header av-paddingTop av-card" data-zop="{&quot;authorName&quot;:&quot;陈安&quot;,&quot;itemId&quot;:&quot;32251040&quot;,&quot;title&quot;:&quot;【游戏框架系列】用C++画光（二）——矩形&quot;,&quot;type&quot;:&quot;article&quot;}"><div class="TitleImage"><img alt="【游戏框架系列】用C++画光（二）——矩形" src="https://pic2.zhimg.com/v2-75242bb0d26268f08e5153138baf7814_r.jpg" class="TitleImage-imagePure"/></div><h1 class="PostIndex-title av-paddingSide av-titleFont">【游戏框架系列】用C++画光（二）——矩形</h1><div class="PostIndex-author"><a href="https://www.zhihu.com/people/bajdcc" target="_blank" rel="noopener noreferrer"><img class="Avatar-hemingway PostIndex-authorAvatar Avatar--xs" alt="陈安" src="https://pic1.zhimg.com/v2-cd6d61ad9ef94c41b9e77f8e0f727893_xs.jpg" srcset="https://pic1.zhimg.com/v2-cd6d61ad9ef94c41b9e77f8e0f727893_l.jpg 2x"/></a><a href="https://www.zhihu.com/people/bajdcc" target="_blank" class="PostIndex-authorName">陈安</a><span class="Bull"></span><div class="HoverTitle" data-hover-title="Fri, Dec 22, 2017 12:39 PM"><time datetime="Fri Dec 22 2017 12:39:01 GMT+0800 (CST)">10 hours ago</time></div></div></div><div class="RichText PostIndex-content av-paddingSide av-card"><p>在上篇文章的基础上，做了许多调整，修复了许多BUG。在解决bug的过程中，我逐渐领悟到一个要领：枯燥地一步步调试太痛苦了，找不到问题的根源！所以我选择将中间结果打到图片上。如：</p><p>（注意，里面的点是我随便点的，有互动了吧）</p><figure><noscript><img src="https://pic2.zhimg.com/v2-9f98c82c10b472a4a8cfc307d08fa353_b.jpg" data-size="normal" data-rawwidth="1031" data-rawheight="628" class="origin_image zh-lightbox-thumb" width="1031" data-original="https://pic2.zhimg.com/v2-9f98c82c10b472a4a8cfc307d08fa353_r.jpg"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='1031'%20height='628'&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1031" data-rawheight="628" class="origin_image zh-lightbox-thumb lazy" width="1031" data-original="https://pic2.zhimg.com/v2-9f98c82c10b472a4a8cfc307d08fa353_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-9f98c82c10b472a4a8cfc307d08fa353_b.jpg"><figcaption>调试光线和最近交点法线</figcaption></figure><figure><noscript><img src="https://pic2.zhimg.com/v2-ab0ba531f68c10d3374ec47ffbf5cfc5_b.jpg" data-size="normal" data-rawwidth="1031" data-rawheight="628" class="origin_image zh-lightbox-thumb" width="1031" data-original="https://pic2.zhimg.com/v2-ab0ba531f68c10d3374ec47ffbf5cfc5_r.jpg"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='1031'%20height='628'&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1031" data-rawheight="628" class="origin_image zh-lightbox-thumb lazy" width="1031" data-original="https://pic2.zhimg.com/v2-ab0ba531f68c10d3374ec47ffbf5cfc5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ab0ba531f68c10d3374ec47ffbf5cfc5_b.jpg"><figcaption>调试光线和最远交点法线</figcaption></figure><p>这就非常爽了！</p><p><br></p><p>本文分两个部分，一个是交并差的实现，一个是矩形的实现。</p><p><br></p><h2>基本数据结构</h2><div class="highlight"><pre><code class="language-cpp"><span></span><span class="c1">// 点信息</span>
<span class="k">struct</span> <span class="n">Geo2DPoint</span>
<span class="p">{</span>
    <span class="n">Geo2DPoint</span><span class="p">();</span>
    <span class="n">Geo2DPoint</span><span class="p">(</span><span class="kt">float</span> <span class="n">distance</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">position</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">normal</span><span class="p">);</span>

    <span class="k">const</span> <span class="n">Geo2DPoint</span><span class="o">&amp;</span> <span class="k">operator</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">Geo2DPoint</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">);</span>

    <span class="kt">float</span> <span class="n">distance</span><span class="p">{</span> <span class="n">FLT_MAX</span> <span class="p">};</span> <span class="c1">// 光线起点到交点距离</span>
    <span class="n">vector2</span> <span class="n">position</span><span class="p">;</span> <span class="c1">// 交点位置</span>
    <span class="n">vector2</span> <span class="n">normal</span><span class="p">;</span> <span class="c1">// 交点法向量（指向物体外部）</span>
<span class="p">};</span>

<span class="c1">// 相交测试</span>
<span class="k">struct</span> <span class="n">Geo2DResult</span>
<span class="p">{</span>
    <span class="n">Geo2DResult</span><span class="p">();</span>
    <span class="n">Geo2DResult</span><span class="p">(</span><span class="k">const</span> <span class="n">Geo2DShape</span><span class="o">*</span> <span class="n">body</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">inside</span><span class="p">,</span> <span class="n">Geo2DPoint</span> <span class="n">min_pt</span><span class="p">,</span> <span class="n">Geo2DPoint</span> <span class="n">max_pt</span><span class="p">);</span>

    <span class="n">Geo2DResult</span><span class="p">(</span><span class="k">const</span> <span class="n">Geo2DResult</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">);</span>
    <span class="k">const</span> <span class="n">Geo2DResult</span><span class="o">&amp;</span> <span class="k">operator</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">Geo2DResult</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">);</span>

    <span class="k">const</span> <span class="n">Geo2DShape</span><span class="o">*</span> <span class="n">body</span><span class="p">{</span> <span class="k">nullptr</span> <span class="p">};</span>
    <span class="kt">bool</span> <span class="n">inside</span><span class="p">{</span> <span class="nb">false</span> <span class="p">};</span>
    <span class="n">Geo2DPoint</span> <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">;</span><span class="c1">//交点较小解和较大解的信息</span>
<span class="p">};</span>
</code></pre></div><p><br></p><p>每次发出一道光线，需要计算：</p><ol><li>如果光线与某物体相交，返回该物体指针body</li><li>光线起点是否在物体内部inside</li><li>光线与物体<b>最近的</b>交点信息，包括交点坐标、光线起点到交点的距离、交点法线，如果此时光线起点位于物体内部，那么交点可能不是最近的（<b>因为这里的最近指的是解二次方程时的较小根</b>）</li><li>光线与物体<b>最远的</b>交点信息</li></ol><p><br></p><p>说明：</p><ul><li>即使光线与物体未有交点，还是要计算出所有交点信息</li><li>不只是最近的交点信息很重要，最远的交点同样重要</li></ul><p><br></p><p>原因：</p><ul><li>上面的数据结构是为了解决图形间交并差的问题！！</li><li>如两圆相交，ABAB的光线路径，那么光线与物体相交的两个点<b>不同时是</b>光线离A、B的最近点，所以最远点的信息是必须要计算的</li><li>为什么要用inside？同样是与A、B相交，<b>光线起点在物体内部和在物体外部所产生的效果是不一样的</b>！因为我们还要计算法线呢！</li><li>……因此促成了现在的数据结构</li></ul><hr><h2>图形间的交、并、差</h2><p>上一篇文章中，虽然实现了交并差，但是还不完善：交点信息和法向量没有计算正确，因此做了调整（并集没有调整）：</p><p><br></p><p>【计算交集】</p><p><a href="https://link.zhihu.com/?target=https%3A//github.com/bajdcc/GameFramework/blob/master/CCGameFramework/base/pe2d/Geometries2D.cpp%23L70" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/bajdcc/GameF</span><span class="invisible">ramework/blob/master/CCGameFramework/base/pe2d/Geometries2D.cpp#L70</span><span class="ellipsis"></span><i class="icon-external"></i></a></p><div class="highlight"><pre><code class="language-cpp"><span></span><span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="n">t_intersect</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">-&gt;</span><span class="n">sample</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">dst</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">body</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="k">auto</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">obj2</span><span class="o">-&gt;</span><span class="n">sample</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">dst</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">body</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span> <span class="n">rd</span> <span class="o">=</span> <span class="p">((</span><span class="n">r1</span><span class="p">.</span><span class="n">inside</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">inside</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">rd</span><span class="p">)</span>
            <span class="p">{</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="c1">// not(A or B)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// AABB</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// ABBA</span>
                        <span class="k">return</span> <span class="n">r2</span><span class="p">;</span>
                    <span class="k">auto</span> <span class="nf">r</span><span class="p">(</span><span class="n">r2</span><span class="p">);</span> <span class="c1">// ABAB</span>
                    <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>

                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BBAA</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BAAB</span>
                        <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
                    <span class="k">auto</span> <span class="nf">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span> <span class="c1">// BABA</span>
                    <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="c1">// B</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// ABA</span>
                    <span class="p">{</span>
                        <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
                        <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="c1">// AAB</span>
                    <span class="p">{</span>
                        <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
                        <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="c1">// A</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BAB</span>
                    <span class="p">{</span>
                        <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r2</span><span class="p">);</span>
                        <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="c1">// BBA</span>
                    <span class="p">{</span>
                        <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r2</span><span class="p">);</span>
                        <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="c1">// A and B</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BA</span>
                    <span class="p">{</span>
                        <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r2</span><span class="p">);</span>
                        <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">;</span>
                        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="c1">// AB</span>
                    <span class="p">{</span>
                        <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// AB</span>
                    <span class="p">{</span>
                        <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
                        <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">;</span>
                        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="c1">// AB</span>
                    <span class="p">{</span>
                        <span class="k">return</span> <span class="n">r2</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p><br></p><p>【计算差集】</p><p>这里注意的是某些情况下需要做法向量翻转</p><p><a href="https://link.zhihu.com/?target=https%3A//github.com/bajdcc/GameFramework/blob/master/CCGameFramework/base/pe2d/Geometries2D.cpp%23L171" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/bajdcc/GameF</span><span class="invisible">ramework/blob/master/CCGameFramework/base/pe2d/Geometries2D.cpp#L171</span><span class="ellipsis"></span><i class="icon-external"></i></a></p><div class="highlight"><pre><code class="language-cpp"><span></span><span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="n">t_subtract</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">-&gt;</span><span class="n">sample</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">dst</span><span class="p">);</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">obj2</span><span class="o">-&gt;</span><span class="n">sample</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">dst</span><span class="p">);</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">rd</span> <span class="o">=</span> <span class="p">((</span><span class="n">r1</span><span class="p">.</span><span class="n">body</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">body</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">rd</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="c1">// not(A or B)</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="c1">// B</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="c1">// A</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">inside</span><span class="p">)</span> <span class="c1">// AA</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">==</span> <span class="n">FLT_MAX</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
            <span class="k">auto</span> <span class="nf">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
            <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
            <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="c1">// A and B</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">inside</span> <span class="o">&amp;&amp;</span> <span class="n">r2</span><span class="p">.</span><span class="n">inside</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BA</span>
            <span class="p">{</span>
                <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
                <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span><span class="p">;</span>
                <span class="n">r</span><span class="p">.</span><span class="n">inside</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="c1">// AB</span>
            <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">inside</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// ABA</span>
                <span class="p">{</span>
                    <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
                    <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                    <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span><span class="p">;</span>
                    <span class="n">r</span><span class="p">.</span><span class="n">inside</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="c1">// BAA</span>
                <span class="p">{</span>
                    <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="c1">// AAB</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">inside</span><span class="p">)</span> <span class="c1">// BAB</span>
        <span class="p">{</span>
            <span class="k">auto</span> <span class="n">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>
            <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// AABB</span>
                    <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// ABBA</span>
                    <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
                <span class="k">auto</span> <span class="nf">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span> <span class="c1">// ABAB</span>
                <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">min_pt</span><span class="p">;</span>
                <span class="n">r</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">normal</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BBAA</span>
                    <span class="k">return</span> <span class="n">r1</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span> <span class="c1">// BAAB</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">auto</span> <span class="nf">r</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span> <span class="c1">// BABA</span>
                <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">max_pt</span><span class="p">;</span>
                <span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">.</span><span class="n">min_pt</span><span class="p">.</span><span class="n">normal</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="k">default</span><span class="o">:</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>想知道代码为什么这么写，需要拿张纸比划一下（逃</p><p>为什么这么多if？？？因为我可以调试啊（最开始两张图），当什么问题都解决完的时候，代码就变这么长了。</p><hr><h2>矩形的实现</h2><p>一开始圆的实现非常简单，因为算个距离很快，法向量就更简单，而矩形不同。</p><p><br></p><p>【矩形】</p><div class="highlight"><pre><code class="language-cpp"><span></span><span class="k">static</span> <span class="kt">int</span> <span class="nf">SignBit</span><span class="p">(</span><span class="k">const</span> <span class="kt">float</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">)</span><span class="c1">//返回a的符号</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPSILON</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span><span class="c1">//接近0</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">IntersectWithLineAB</span><span class="p">(</span><span class="k">const</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">ori</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">dir</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">p2</span><span class="p">,</span> <span class="kt">float</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">,</span> <span class="n">vector2</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="c1">//利用直线的参数方程计算一直线与另一直线的交点</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">tAB1</span> <span class="o">=</span> <span class="n">dir</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">dir</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="p">);</span><span class="c1">//计算平行</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">tAB1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">EPSILON</span><span class="p">)</span><span class="c1">//不平行必有交点</span>
    <span class="p">{</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">((</span><span class="n">ori</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">ori</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">tAB1</span><span class="p">;</span><span class="c1">//计算距离</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ori</span> <span class="o">+</span> <span class="n">dir</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span><span class="c1">//计算交点</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">SignBit</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">SignBit</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">SignBit</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">SignBit</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">));</span><span class="c1">//交点是否在p1p2间</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span><span class="c1">//两直线平行，无交点</span>
<span class="p">}</span>

<span class="n">Geo2DResult</span> <span class="n">Geo2DBox</span><span class="o">::</span><span class="n">sample</span><span class="p">(</span><span class="n">vector2</span> <span class="n">ori</span><span class="p">,</span> <span class="n">vector2</span> <span class="n">dir</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">_A</span> <span class="o">=</span> <span class="n">vector2</span><span class="p">(</span><span class="n">costheta</span> <span class="o">*</span> <span class="o">-</span><span class="n">s</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">sintheta</span> <span class="o">*</span> <span class="o">-</span><span class="n">s</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">costheta</span> <span class="o">*</span> <span class="o">-</span><span class="n">s</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">sintheta</span> <span class="o">*</span> <span class="o">-</span><span class="n">s</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">_B</span> <span class="o">=</span> <span class="n">vector2</span><span class="p">(</span><span class="n">costheta</span> <span class="o">*</span> <span class="n">s</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">sintheta</span> <span class="o">*</span> <span class="o">-</span><span class="n">s</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">costheta</span> <span class="o">*</span> <span class="o">-</span><span class="n">s</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">sintheta</span> <span class="o">*</span> <span class="n">s</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">A</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="n">_A</span><span class="p">;</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">B</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="n">_B</span><span class="p">;</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">C</span> <span class="o">=</span> <span class="n">center</span> <span class="o">-</span> <span class="n">_A</span><span class="p">;</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">D</span> <span class="o">=</span> <span class="n">center</span> <span class="o">-</span> <span class="n">_B</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">vector2</span> <span class="n">pts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span> <span class="p">};</span>

    <span class="k">static</span> <span class="kt">int</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},{</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">}</span> <span class="p">};</span>
    <span class="kt">float</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="c1">//保存两交点的距离</span>
    <span class="n">vector2</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="c1">//保存两交点的位置</span>
    <span class="kt">int</span> <span class="n">ids</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="c1">//保存与矩形哪一条边相交</span>
    <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IntersectWithLineAB</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="n">t</span><span class="p">[</span><span class="n">cnt</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">cnt</span><span class="p">]))</span>
        <span class="p">{</span>
            <span class="n">ids</span><span class="p">[</span><span class="n">cnt</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="c1">//有两个交点</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="k">auto</span> <span class="n">td</span> <span class="o">=</span> <span class="p">((</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">td</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="c1">// 双反，无交点，在外</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="c1">// t[1]，有交点，在内</span>
<span class="c1">//只与t1相交，那么t0肯定是另一交点，p0肯定为负</span>
            <span class="k">return</span> <span class="n">Geo2DResult</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span>
                <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)),</span>
                <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)));</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="c1">// t[0]，有交点，在内</span>
<span class="c1">//只与t0相交，那么t1肯定是另一交点，p1肯定为负</span>
            <span class="k">return</span> <span class="n">Geo2DResult</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span>
                <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)),</span>
                <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)));</span>
        <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="c1">// 双正，有交点，在外</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="c1">//都相交？就看看哪个交点更近了</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">Geo2DResult</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span>
                    <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)),</span>
                    <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)));</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">Geo2DResult</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span>
                    <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)),</span>
                    <span class="n">Geo2DPoint</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">center</span> <span class="o">-</span> <span class="n">center</span><span class="p">)));</span>
            <span class="p">}</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">Geo2DResult</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div><p>其实过程不复杂（我一晚上竟然能搞定哈哈，这归功于调试方法的先进性），计算法向量很简单，就是两个对角线的叠加方向。。</p><p>有几个注意点：</p><ul><li>求符号SignBit自己写的，用fsignbit导致gg（算我不会用吧），我相信编译器的优化能力</li><li>知矩形中心点、两轴距离、旋转角度后，要计算出四点的坐标，这时有计算顺序，一开始只能将旋转矩阵应用于(sx,sy)轴向量！不能用于四点的真实坐标，相当于先在矩形的本地坐标系中应用旋转，最后才加上矩形自身的位置偏移</li><li>为什么要用参数方程做，不用y=kx+b做：如果这时的直线是竖直方向的呢？y=kx+b就不能表达了</li><li>求出了交点，要判断交点是否在线段AB上，做法是x坐标和y坐标相减判断同符号，不能用y=kx+b算距离求比值在0~1间，这样即不正确也不高效</li></ul><p><br></p><h2>小结</h2><p>矩形会做之后，多边形应该都能搞定了，如三角形，只要考虑一下三边的方向即向（即判断是在内还是在外）。</p><p>做完之后，在做反射、折射，这简单了！因为距离呀交点呀法向量全部求出来了。</p><p>读过<a href="https://zhuanlan.zhihu.com/p/32078689" class="internal">用C++画光（一）</a> 后，看了他的代码<a href="https://link.zhihu.com/?target=https%3A//github.com/lilypuye/cppLight2d/blob/master/Shape.h%23L281" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/lilypuye/cpp</span><span class="invisible">Light2d/blob/master/Shape.h#L281</span><span class="ellipsis"></span><i class="icon-external"></i></a>， <a class="member_mention" href="https://www.zhihu.com/people/60b3962bb460ac1677bfe9104e362743" data-hash="60b3962bb460ac1677bfe9104e362743" data-hovercard="p$b$60b3962bb460ac1677bfe9104e362743">@浦夜</a> 他的差集没有实现出来，一方面是设计思路的问题，另一方面是debug繁琐的问题（运行一下，打开一张图片，当然烦了），其实本质是缺少一个可视化界面，有了界面，问题就变得简单了。他的光色散我要尝试下，简直太美。</p><p>至于我为什么要在框架中实现这个效果：一者，可视化+互动；二者，与众不同；三者，框架要有例子才能证明好用啊。</p></div><div class="PostIndex-footer"><div class="PostIndex-topics TopicItem-wrapper"><a class="TopicItem u-ellipsis PostIndex-topicItem" href="https://www.zhihu.com/topic/19613730">计算机图形学</a><a class="TopicItem u-ellipsis PostIndex-topicItem" href="https://www.zhihu.com/topic/19601705">C / C++</a><a class="TopicItem u-ellipsis PostIndex-topicItem" href="https://www.zhihu.com/topic/19554298">编程</a></div><div class="PostIndex-reviewers"></div><div class="PostIndex-vote"><button class="Button PostIndex-voteButton Button--green" aria-label="赞" type="button"><i class="icon icon-ic_column_like"></i>5</button><div class="PostIndex-voters"><div class="HoverTitle HoverTitle--slim" data-hover-title="fmname"><a href="https://www.zhihu.com/people/fmname" class="PostIndex-voter" target="_blank"><img class="Avatar-hemingway Avatar--is" alt="fmname" src="https://pic3.zhimg.com/40af1c04dbb5f93fdd765719b3a0c183_is.jpg" srcset="https://pic3.zhimg.com/40af1c04dbb5f93fdd765719b3a0c183_im.jpg 2x"/></a></div><div class="HoverTitle HoverTitle--slim" data-hover-title="昌维"><a href="https://www.zhihu.com/people/changwei1997" class="PostIndex-voter" target="_blank"><img class="Avatar-hemingway Avatar--is" alt="昌维" src="https://pic2.zhimg.com/af3fe199b1b457a29ccb1835274335e1_is.jpg" srcset="https://pic2.zhimg.com/af3fe199b1b457a29ccb1835274335e1_im.jpg 2x"/></a></div><div class="HoverTitle HoverTitle--slim" data-hover-title="渣渣"><a href="https://www.zhihu.com/people/zha-zha-48-87" class="PostIndex-voter" target="_blank"><img class="Avatar-hemingway Avatar--is" alt="渣渣" src="https://pic4.zhimg.com/da8e974dc_is.jpg" srcset="https://pic4.zhimg.com/da8e974dc_im.jpg 2x"/></a></div><div class="HoverTitle HoverTitle--slim" data-hover-title="枫子"><a href="https://www.zhihu.com/people/feng-zi-23-49" class="PostIndex-voter" target="_blank"><img class="Avatar-hemingway Avatar--is" alt="枫子" src="https://pic4.zhimg.com/da8e974dc_is.jpg" srcset="https://pic4.zhimg.com/da8e974dc_im.jpg 2x"/></a></div><div class="HoverTitle HoverTitle--slim" data-hover-title="Porphyah"><a href="https://www.zhihu.com/people/porphyah" class="PostIndex-voter" target="_blank"><img class="Avatar-hemingway Avatar--is" alt="Porphyah" src="https://pic4.zhimg.com/v2-0010658e5fc4b6c50ca66ccbca52c0b8_is.jpg" srcset="https://pic4.zhimg.com/v2-0010658e5fc4b6c50ca66ccbca52c0b8_im.jpg 2x"/></a></div><a href="/p/32251040/voters" target="_blank" rel="noopener noreferrer" title="查看全部" class="PostIndex-allVoters"><i class="icon-ic_like_more"></i></a></div></div><div class="PostIndex-control"><div class="Fav"><button class="Button Button Button--plain FavButton" type="button"><i class="icon icon-ic_collect"></i>收藏</button></div><div class="PostShare"><div class="Menu"><button class="Button Button Button--plain MenuButton MenuButton-listen-hover Button Button--plain" type="button"><i class="icon icon-ic_column_share"></i>分享</button><div class="Menu-dropdown" style="visibility:hidden;"></div></div></div><div class="Report"><button class="Button Button Button--plain ReportButton" type="button"><i class="icon icon-ic_column_report"></i>举报</button></div></div></div><div class="Contributes PostIndex-contributes av-card"><div class="BlockTitle av-marginLeft av-borderColor"><span class="BlockTitle-title">文章被以下专栏收录</span><span class="BlockTitle-line"></span></div><ul class="Contributes-list"><li style="opacity:1;max-height:300px;" class="Contributes-listItem av-borderColor av-marginLeft"><div class="ContributesItem av-paddingRight" role="link"><a class="ContributesItem-avatar" href="/learncpp"><img class="Avatar-hemingway" src="https://pic4.zhimg.com/v2-bf63794c542fc73b11e17014b7e0d01d_m.jpg" srcset="https://pic4.zhimg.com/v2-bf63794c542fc73b11e17014b7e0d01d_xl.jpg 2x"/></a><div class="ContributesItem-info"><div class="ContributesItem-nameLine"><a class="ContributesItem-name" href="https://zhuanlan.zhihu.com/learncpp">学习C++</a></div><p class="ContributesItem-intro u-ellipsis">写写C++</p></div><a class="ContributesItem-entrance" href="https://zhuanlan.zhihu.com/learncpp">进入专栏</a></div></li></ul></div><div class="PostComment"><div class="BlockTitle av-marginLeft av-borderColor PostComment-blockTitle"><span class="BlockTitle-title">1 条评论</span><span class="BlockTitle-line"></span></div><div class="CommentEditor PostComment-mainEditor"><div class="CommentEditor-input"><div class="CommentEditor-actions"><button class="Button Button--plain" type="button">取消</button><button class="Button Button--blue" disabled="" type="button">评论</button></div></div></div><div class="PostCommentList"></div></div></div></div></div></div><textarea id="clientConfig" hidden="">{&quot;debug&quot;:false,&quot;apiRoot&quot;:&quot;&quot;,&quot;paySDK&quot;:&quot;https:\u002F\u002Fpay.zhihu.com\u002Fapi\u002Fjs&quot;,&quot;wechatConfigAPI&quot;:&quot;\u002Fapi\u002Fwechat\u002Fjssdkconfig&quot;,&quot;name&quot;:&quot;production&quot;,&quot;instance&quot;:&quot;column&quot;,&quot;tokens&quot;:{&quot;X-XSRF-TOKEN&quot;:null,&quot;X-UDID&quot;:null,&quot;Authorization&quot;:&quot;oauth c3cef7c66a1843f8b3a9e6a1e3160e20&quot;}}</textarea><textarea id="preloadedState" hidden="">{&quot;database&quot;:{&quot;Post&quot;:{&quot;32251040&quot;:{&quot;isPending&quot;:false,&quot;contributes&quot;:[{&quot;sourceColumn&quot;:{&quot;lastUpdated&quot;:1497249764,&quot;description&quot;:&quot;玩玩有趣的东西&quot;,&quot;permission&quot;:&quot;COLUMN_PUBLIC&quot;,&quot;memberId&quot;:10760740,&quot;contributePermission&quot;:&quot;COLUMN_PUBLIC&quot;,&quot;translatedCommentPermission&quot;:&quot;all&quot;,&quot;canManage&quot;:true,&quot;intro&quot;:&quot;写写C++&quot;,&quot;urlToken&quot;:&quot;learncpp&quot;,&quot;id&quot;:25963,&quot;imagePath&quot;:&quot;v2-bf63794c542fc73b11e17014b7e0d01d.jpg&quot;,&quot;slug&quot;:&quot;learncpp&quot;,&quot;applyReason&quot;:&quot;0&quot;,&quot;name&quot;:&quot;学习C++&quot;,&quot;title&quot;:&quot;学习C++&quot;,&quot;url&quot;:&quot;https:\u002F\u002Fzhuanlan.zhihu.com\u002Flearncpp&quot;,&quot;commentPermission&quot;:&quot;COLUMN_ALL_CAN_COMMENT&quot;,&quot;canPost&quot;:true,&quot;created&quot;:1483611626,&quot;state&quot;:&quot;COLUMN_NORMAL&quot;,&quot;followers&quot;:3120,&quot;avatar&quot;:{&quot;id&quot;:&quot;v2-bf63794c542fc73b11e17014b7e0d01d&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic4.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;activateAuthorRequested&quot;:false,&quot;following&quot;:false,&quot;imageUrl&quot;:&quot;https:\u002F\u002Fpic4.zhimg.com\u002Fv2-bf63794c542fc73b11e17014b7e0d01d_l.jpg&quot;,&quot;articlesCount&quot;:55},&quot;state&quot;:&quot;accepted&quot;,&quot;targetPost&quot;:{&quot;titleImage&quot;:&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-75242bb0d26268f08e5153138baf7814_r.jpg&quot;,&quot;lastUpdated&quot;:1513918061,&quot;imagePath&quot;:&quot;v2-75242bb0d26268f08e5153138baf7814.png&quot;,&quot;permission&quot;:&quot;ARTICLE_PUBLIC&quot;,&quot;topics&quot;:[21222,17215,1354],&quot;summary&quot;:&quot;在上篇文章的基础上，做了许多调整，修复了许多BUG。在解决bug的过程中，我逐渐领悟到一个要领：枯燥地一步步调试太痛苦了，找不到问题的根源！所以我选择将中间结果打到图片上。如：（注意，里面的点是我随便点的，有互动了吧）这就非常爽了！ 本文分两个…&quot;,&quot;copyPermission&quot;:&quot;ARTICLE_COPYABLE&quot;,&quot;translatedCommentPermission&quot;:&quot;all&quot;,&quot;likes&quot;:0,&quot;origAuthorId&quot;:0,&quot;publishedTime&quot;:&quot;2017-12-22T12:39:01+08:00&quot;,&quot;sourceUrl&quot;:&quot;&quot;,&quot;urlToken&quot;:32251040,&quot;id&quot;:5089656,&quot;withContent&quot;:false,&quot;slug&quot;:32251040,&quot;bigTitleImage&quot;:true,&quot;title&quot;:&quot;【游戏框架系列】用C++画光（二）——矩形&quot;,&quot;url&quot;:&quot;\u002Fp\u002F32251040&quot;,&quot;commentPermission&quot;:&quot;ARTICLE_ALL_CAN_COMMENT&quot;,&quot;snapshotUrl&quot;:&quot;&quot;,&quot;created&quot;:1513917541,&quot;comments&quot;:0,&quot;columnId&quot;:0,&quot;content&quot;:&quot;&quot;,&quot;parentId&quot;:0,&quot;state&quot;:&quot;ARTICLE_PUBLISHED&quot;,&quot;imageUrl&quot;:&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-75242bb0d26268f08e5153138baf7814_r.jpg&quot;,&quot;author&quot;:{&quot;bio&quot;:&quot;专业研究野生技术&quot;,&quot;isFollowing&quot;:false,&quot;hash&quot;:&quot;7a228f3d98a5d011f952110c10dc4976&quot;,&quot;uid&quot;:71809588264960,&quot;isOrg&quot;:false,&quot;slug&quot;:&quot;bajdcc&quot;,&quot;isFollowed&quot;:false,&quot;description&quot;:&quot;发现编程的乐趣 https:\u002F\u002Fgithub.com\u002Fbajdcc&quot;,&quot;name&quot;:&quot;陈安&quot;,&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fbajdcc&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;v2-cd6d61ad9ef94c41b9e77f8e0f727893&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic1.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false},&quot;memberId&quot;:10760740,&quot;excerptTitle&quot;:&quot;&quot;,&quot;voteType&quot;:&quot;ARTICLE_VOTE_CLEAR&quot;},&quot;id&quot;:999497}],&quot;title&quot;:&quot;【游戏框架系列】用C++画光（二）——矩形&quot;,&quot;author&quot;:&quot;bajdcc&quot;,&quot;content&quot;:&quot;\u003Cp\u003E在上篇文章的基础上，做了许多调整，修复了许多BUG。在解决bug的过程中，我逐渐领悟到一个要领：枯燥地一步步调试太痛苦了，找不到问题的根源！所以我选择将中间结果打到图片上。如：\u003C\u002Fp\u003E\u003Cp\u003E（注意，里面的点是我随便点的，有互动了吧）\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cnoscript\u003E\u003Cimg src=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f98c82c10b472a4a8cfc307d08fa353_b.jpg\&quot; data-size=\&quot;normal\&quot; data-rawwidth=\&quot;1031\&quot; data-rawheight=\&quot;628\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;1031\&quot; data-original=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f98c82c10b472a4a8cfc307d08fa353_r.jpg\&quot;\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\&quot;data:image\u002Fsvg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#x27;%20width=&#x27;1031&#x27;%20height=&#x27;628&#x27;&amp;gt;&amp;lt;\u002Fsvg&amp;gt;\&quot; data-size=\&quot;normal\&quot; data-rawwidth=\&quot;1031\&quot; data-rawheight=\&quot;628\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;1031\&quot; data-original=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f98c82c10b472a4a8cfc307d08fa353_r.jpg\&quot; data-actualsrc=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f98c82c10b472a4a8cfc307d08fa353_b.jpg\&quot;\u003E\u003Cfigcaption\u003E调试光线和最近交点法线\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure\u003E\u003Cnoscript\u003E\u003Cimg src=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ab0ba531f68c10d3374ec47ffbf5cfc5_b.jpg\&quot; data-size=\&quot;normal\&quot; data-rawwidth=\&quot;1031\&quot; data-rawheight=\&quot;628\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;1031\&quot; data-original=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ab0ba531f68c10d3374ec47ffbf5cfc5_r.jpg\&quot;\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\&quot;data:image\u002Fsvg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#x27;%20width=&#x27;1031&#x27;%20height=&#x27;628&#x27;&amp;gt;&amp;lt;\u002Fsvg&amp;gt;\&quot; data-size=\&quot;normal\&quot; data-rawwidth=\&quot;1031\&quot; data-rawheight=\&quot;628\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;1031\&quot; data-original=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ab0ba531f68c10d3374ec47ffbf5cfc5_r.jpg\&quot; data-actualsrc=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ab0ba531f68c10d3374ec47ffbf5cfc5_b.jpg\&quot;\u003E\u003Cfigcaption\u003E调试光线和最远交点法线\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E这就非常爽了！\u003C\u002Fp\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E本文分两个部分，一个是交并差的实现，一个是矩形的实现。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Ch2\u003E基本数据结构\u003C\u002Fh2\u003E\u003Cdiv class=\&quot;highlight\&quot;\u003E\u003Cpre\u003E\u003Ccode class=\&quot;language-cpp\&quot;\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 点信息\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;k\&quot;\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E();\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;kt\&quot;\u003Efloat\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eposition\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eoperator\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\&quot;kt\&quot;\u003Efloat\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EFLT_MAX\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 光线起点到交点距离\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eposition\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 交点位置\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 交点法向量（指向物体外部）\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E\n\n\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 相交测试\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;k\&quot;\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E();\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DShape\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ebody\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;kt\&quot;\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eoperator\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DShape\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ebody\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Enullptr\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;kt\&quot;\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F交点较小解和较大解的信息\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E每次发出一道光线，需要计算：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E如果光线与某物体相交，返回该物体指针body\u003C\u002Fli\u003E\u003Cli\u003E光线起点是否在物体内部inside\u003C\u002Fli\u003E\u003Cli\u003E光线与物体\u003Cb\u003E最近的\u003C\u002Fb\u003E交点信息，包括交点坐标、光线起点到交点的距离、交点法线，如果此时光线起点位于物体内部，那么交点可能不是最近的（\u003Cb\u003E因为这里的最近指的是解二次方程时的较小根\u003C\u002Fb\u003E）\u003C\u002Fli\u003E\u003Cli\u003E光线与物体\u003Cb\u003E最远的\u003C\u002Fb\u003E交点信息\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E说明：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E即使光线与物体未有交点，还是要计算出所有交点信息\u003C\u002Fli\u003E\u003Cli\u003E不只是最近的交点信息很重要，最远的交点同样重要\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E原因：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E上面的数据结构是为了解决图形间交并差的问题！！\u003C\u002Fli\u003E\u003Cli\u003E如两圆相交，ABAB的光线路径，那么光线与物体相交的两个点\u003Cb\u003E不同时是\u003C\u002Fb\u003E光线离A、B的最近点，所以最远点的信息是必须要计算的\u003C\u002Fli\u003E\u003Cli\u003E为什么要用inside？同样是与A、B相交，\u003Cb\u003E光线起点在物体内部和在物体外部所产生的效果是不一样的\u003C\u002Fb\u003E！因为我们还要计算法线呢！\u003C\u002Fli\u003E\u003Cli\u003E……因此促成了现在的数据结构\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Chr\u003E\u003Ch2\u003E图形间的交、并、差\u003C\u002Fh2\u003E\u003Cp\u003E上一篇文章中，虽然实现了交并差，但是还不完善：交点信息和法向量没有计算正确，因此做了调整（并集没有调整）：\u003C\u002Fp\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E【计算交集】\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\&quot;https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fbajdcc\u002FGameFramework\u002Fblob\u002Fmaster\u002FCCGameFramework\u002Fbase\u002Fpe2d\u002FGeometries2D.cpp%23L70\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;\u003E\u003Cspan class=\&quot;invisible\&quot;\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\&quot;visible\&quot;\u003Egithub.com\u002Fbajdcc\u002FGameF\u003C\u002Fspan\u003E\u003Cspan class=\&quot;invisible\&quot;\u003Eramework\u002Fblob\u002Fmaster\u002FCCGameFramework\u002Fbase\u002Fpe2d\u002FGeometries2D.cpp#L70\u003C\u002Fspan\u003E\u003Cspan class=\&quot;ellipsis\&quot;\u003E\u003C\u002Fspan\u003E\u003Ci class=\&quot;icon-external\&quot;\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cdiv class=\&quot;highlight\&quot;\u003E\u003Cpre\u003E\u003Ccode class=\&quot;language-cpp\&quot;\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eop\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et_intersect\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eobj1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E-&amp;gt;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Esample\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edst\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ebody\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eobj2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E-&amp;gt;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Esample\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edst\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ebody\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Erd\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E|\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eswitch\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Erd\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F not(A or B)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AABB\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F ABBA\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F ABAB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BBAA\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BAAB\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BABA\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F B\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F ABA\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AAB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F A\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BAB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BBA\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F A and B\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BA\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Edefault\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E【计算差集】\u003C\u002Fp\u003E\u003Cp\u003E这里注意的是某些情况下需要做法向量翻转\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\&quot;https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fbajdcc\u002FGameFramework\u002Fblob\u002Fmaster\u002FCCGameFramework\u002Fbase\u002Fpe2d\u002FGeometries2D.cpp%23L171\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;\u003E\u003Cspan class=\&quot;invisible\&quot;\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\&quot;visible\&quot;\u003Egithub.com\u002Fbajdcc\u002FGameF\u003C\u002Fspan\u003E\u003Cspan class=\&quot;invisible\&quot;\u003Eramework\u002Fblob\u002Fmaster\u002FCCGameFramework\u002Fbase\u002Fpe2d\u002FGeometries2D.cpp#L171\u003C\u002Fspan\u003E\u003Cspan class=\&quot;ellipsis\&quot;\u003E\u003C\u002Fspan\u003E\u003Ci class=\&quot;icon-external\&quot;\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cdiv class=\&quot;highlight\&quot;\u003E\u003Cpre\u003E\u003Ccode class=\&quot;language-cpp\&quot;\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eop\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et_subtract\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eobj1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E-&amp;gt;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Esample\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edst\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eobj2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E-&amp;gt;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Esample\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edst\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Erd\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ebody\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E|\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ebody\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Eswitch\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Erd\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F not(A or B)\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F B\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F A\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AA\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EFLT_MAX\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F A and B\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BA\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AB\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F ABA\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BAA\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AAB\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Einside\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BAB\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F AABB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F ABBA\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F ABAB\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BBAA\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Edistance\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BAAB\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F BABA\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emax_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Emin_pt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Enormal\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Edefault\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E想知道代码为什么这么写，需要拿张纸比划一下（逃\u003C\u002Fp\u003E\u003Cp\u003E为什么这么多if？？？因为我可以调试啊（最开始两张图），当什么问题都解决完的时候，代码就变这么长了。\u003C\u002Fp\u003E\u003Chr\u003E\u003Ch2\u003E矩形的实现\u003C\u002Fh2\u003E\u003Cp\u003E一开始圆的实现非常简单，因为算个距离很快，法向量就更简单，而矩形不同。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cp\u003E【矩形】\u003C\u002Fp\u003E\u003Cdiv class=\&quot;highlight\&quot;\u003E\u003Cpre\u003E\u003Ccode class=\&quot;language-cpp\&quot;\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\&quot;kt\&quot;\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003ESignBit\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;kt\&quot;\u003Efloat\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F返回a的符号\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Efabs\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EEPSILON\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F接近0\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ea\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\&quot;k\&quot;\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\&quot;kt\&quot;\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nf\&quot;\u003EIntersectWithLineAB\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edir\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;kt\&quot;\u003Efloat\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F利用直线的参数方程计算一直线与另一直线的交点\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EtAB1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edir\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edir\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F计算平行\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Efabs\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003EtAB1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EEPSILON\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F不平行必有交点\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E))\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EtAB1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F计算距离\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edir\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F计算交点\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003ESignBit\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ESignBit\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E))\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003ESignBit\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ESignBit\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E));\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F交点是否在p1p2间\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F两直线平行，无交点\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DBox\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Esample\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edir\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003E_A\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ecostheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Esintheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecostheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Esintheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003E_B\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ecostheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Esintheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecostheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Esintheta\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EA\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003E_A\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EB\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003E_B\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EC\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003E_A\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ED\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003E_B\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EA\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003EB\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003EC\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003ED\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\&quot;k\&quot;\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\&quot;kt\&quot;\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E},{\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E},{\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E},{\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E};\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;kt\&quot;\u003Efloat\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E];\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F保存两交点的距离\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;n\&quot;\u003Evector2\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E];\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F保存两交点的位置\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;kt\&quot;\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E];\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F保存与矩形哪一条边相交\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;kt\&quot;\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecnt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;kt\&quot;\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ei\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ei\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E4\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;amp;&amp;amp;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecnt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003EIntersectWithLineAB\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eori\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Edir\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ecnt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ecnt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]))\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ecnt\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Ecnt\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F有两个交点\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\&quot;k\&quot;\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Etd\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;lt;&amp;lt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E|\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;=\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E);\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Eswitch\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Etd\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 双反，无交点，在外\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F t[1]，有交点，在内\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F只与t1相交，那么t0肯定是另一交点，p0肯定为负\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)),\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)));\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F t[0]，有交点，在内\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F只与t0相交，那么t1肯定是另一交点，p1肯定为负\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)),\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)));\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\&quot;mi\&quot;\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F 双正，有交点，在外\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E&amp;gt;\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E])\u003C\u002Fspan\u003E\u003Cspan class=\&quot;c1\&quot;\u003E\u002F\u002F都相交？就看看哪个交点更近了\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)),\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)));\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Eelse\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;k\&quot;\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\&quot;nb\&quot;\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E,\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)),\u003C\u002Fspan\u003E\n                    \u003Cspan class=\&quot;n\&quot;\u003EGeo2DPoint\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ep\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E],\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003ENormalize\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Epts\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;n\&quot;\u003Eids\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]][\u003C\u002Fspan\u003E\u003Cspan class=\&quot;mi\&quot;\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E \u003Cspan class=\&quot;o\&quot;\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003Ecenter\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E)));\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;k\&quot;\u003Edefault\u003C\u002Fspan\u003E\u003Cspan class=\&quot;o\&quot;\u003E:\u003C\u002Fspan\u003E\n            \u003Cspan class=\&quot;k\&quot;\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\&quot;k\&quot;\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\&quot;n\&quot;\u003EGeo2DResult\u003C\u002Fspan\u003E\u003Cspan class=\&quot;p\&quot;\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\&quot;p\&quot;\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E其实过程不复杂（我一晚上竟然能搞定哈哈，这归功于调试方法的先进性），计算法向量很简单，就是两个对角线的叠加方向。。\u003C\u002Fp\u003E\u003Cp\u003E有几个注意点：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E求符号SignBit自己写的，用fsignbit导致gg（算我不会用吧），我相信编译器的优化能力\u003C\u002Fli\u003E\u003Cli\u003E知矩形中心点、两轴距离、旋转角度后，要计算出四点的坐标，这时有计算顺序，一开始只能将旋转矩阵应用于(sx,sy)轴向量！不能用于四点的真实坐标，相当于先在矩形的本地坐标系中应用旋转，最后才加上矩形自身的位置偏移\u003C\u002Fli\u003E\u003Cli\u003E为什么要用参数方程做，不用y=kx+b做：如果这时的直线是竖直方向的呢？y=kx+b就不能表达了\u003C\u002Fli\u003E\u003Cli\u003E求出了交点，要判断交点是否在线段AB上，做法是x坐标和y坐标相减判断同符号，不能用y=kx+b算距离求比值在0~1间，这样即不正确也不高效\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Ch2\u003E小结\u003C\u002Fh2\u003E\u003Cp\u003E矩形会做之后，多边形应该都能搞定了，如三角形，只要考虑一下三边的方向即向（即判断是在内还是在外）。\u003C\u002Fp\u003E\u003Cp\u003E做完之后，在做反射、折射，这简单了！因为距离呀交点呀法向量全部求出来了。\u003C\u002Fp\u003E\u003Cp\u003E读过\u003Ca href=\&quot;https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F32078689\&quot; class=\&quot;internal\&quot;\u003E用C++画光（一）\u003C\u002Fa\u003E 后，看了他的代码\u003Ca href=\&quot;https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Flilypuye\u002FcppLight2d\u002Fblob\u002Fmaster\u002FShape.h%23L281\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;\u003E\u003Cspan class=\&quot;invisible\&quot;\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\&quot;visible\&quot;\u003Egithub.com\u002Flilypuye\u002Fcpp\u003C\u002Fspan\u003E\u003Cspan class=\&quot;invisible\&quot;\u003ELight2d\u002Fblob\u002Fmaster\u002FShape.h#L281\u003C\u002Fspan\u003E\u003Cspan class=\&quot;ellipsis\&quot;\u003E\u003C\u002Fspan\u003E\u003Ci class=\&quot;icon-external\&quot;\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E， \u003Ca class=\&quot;member_mention\&quot; href=\&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002F60b3962bb460ac1677bfe9104e362743\&quot; data-hash=\&quot;60b3962bb460ac1677bfe9104e362743\&quot; data-hovercard=\&quot;p$b$60b3962bb460ac1677bfe9104e362743\&quot;\u003E@浦夜\u003C\u002Fa\u003E 他的差集没有实现出来，一方面是设计思路的问题，另一方面是debug繁琐的问题（运行一下，打开一张图片，当然烦了），其实本质是缺少一个可视化界面，有了界面，问题就变得简单了。他的光色散我要尝试下，简直太美。\u003C\u002Fp\u003E\u003Cp\u003E至于我为什么要在框架中实现这个效果：一者，可视化+互动；二者，与众不同；三者，框架要有例子才能证明好用啊。\u003C\u002Fp\u003E&quot;,&quot;updated&quot;:new Date(&quot;2017-12-22T04:39:01.000Z&quot;),&quot;canComment&quot;:false,&quot;commentPermission&quot;:&quot;anyone&quot;,&quot;commentCount&quot;:1,&quot;collapsedCount&quot;:0,&quot;likeCount&quot;:5,&quot;state&quot;:&quot;published&quot;,&quot;isLiked&quot;:false,&quot;slug&quot;:&quot;32251040&quot;,&quot;isTitleImageFullScreen&quot;:true,&quot;rating&quot;:&quot;none&quot;,&quot;titleImage&quot;:&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-75242bb0d26268f08e5153138baf7814_r.jpg&quot;,&quot;links&quot;:{&quot;comments&quot;:&quot;\u002Fapi\u002Fposts\u002F32251040\u002Fcomments&quot;},&quot;reviewers&quot;:[],&quot;topics&quot;:[{&quot;url&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19613730&quot;,&quot;id&quot;:&quot;19613730&quot;,&quot;name&quot;:&quot;计算机图形学&quot;},{&quot;url&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19601705&quot;,&quot;id&quot;:&quot;19601705&quot;,&quot;name&quot;:&quot;C \u002F C++&quot;},{&quot;url&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19554298&quot;,&quot;id&quot;:&quot;19554298&quot;,&quot;name&quot;:&quot;编程&quot;}],&quot;adminClosedComment&quot;:false,&quot;titleImageSize&quot;:{&quot;width&quot;:1920,&quot;height&quot;:1040},&quot;href&quot;:&quot;\u002Fapi\u002Fposts\u002F32251040&quot;,&quot;excerptTitle&quot;:&quot;&quot;,&quot;tipjarState&quot;:&quot;inactivated&quot;,&quot;annotationAction&quot;:[],&quot;sourceUrl&quot;:&quot;&quot;,&quot;pageCommentsCount&quot;:1,&quot;hasPublishingDraft&quot;:false,&quot;snapshotUrl&quot;:&quot;&quot;,&quot;publishedTime&quot;:&quot;2017-12-22T12:39:01+08:00&quot;,&quot;url&quot;:&quot;\u002Fp\u002F32251040&quot;,&quot;lastestLikers&quot;:[{&quot;bio&quot;:&quot;半瓶水&quot;,&quot;isFollowing&quot;:false,&quot;hash&quot;:&quot;9408fc08455bfc80eb7053aa8c6fa29a&quot;,&quot;uid&quot;:723991269285564400,&quot;isOrg&quot;:false,&quot;slug&quot;:&quot;fmname&quot;,&quot;isFollowed&quot;:false,&quot;description&quot;:&quot;vv&quot;,&quot;name&quot;:&quot;fmname&quot;,&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Ffmname&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;40af1c04dbb5f93fdd765719b3a0c183&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic3.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false},{&quot;bio&quot;:&quot;缺乏持续性输出的知识崇拜者&quot;,&quot;isFollowing&quot;:false,&quot;hash&quot;:&quot;5fe93d9e436715d6d5cb49245af3b88c&quot;,&quot;uid&quot;:73077639610368,&quot;isOrg&quot;:false,&quot;slug&quot;:&quot;changwei1997&quot;,&quot;isFollowed&quot;:false,&quot;description&quot;:&quot;穿梭在虚拟与现实中的隐形单位，平日以上网为精神食粮，以睡觉为心灵治愈。\nhttp:\u002F\u002Fwww.changwei.me&quot;,&quot;name&quot;:&quot;昌维&quot;,&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fchangwei1997&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;af3fe199b1b457a29ccb1835274335e1&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic2.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false},{&quot;bio&quot;:&quot;啊呀呀&quot;,&quot;isFollowing&quot;:false,&quot;hash&quot;:&quot;d174e1391306add435b2fb6e4c8116ec&quot;,&quot;uid&quot;:653880955803275300,&quot;isOrg&quot;:false,&quot;slug&quot;:&quot;zha-zha-48-87&quot;,&quot;isFollowed&quot;:false,&quot;description&quot;:&quot;&quot;,&quot;name&quot;:&quot;渣渣&quot;,&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fzha-zha-48-87&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;da8e974dc&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic4.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false},{&quot;bio&quot;:&quot;落叶，红枫，焚身以火，这就是我的意志。-Weibo&quot;,&quot;isFollowing&quot;:false,&quot;hash&quot;:&quot;d7603d05c426075fd66f30a9ec755dd2&quot;,&quot;uid&quot;:62240665370624,&quot;isOrg&quot;:false,&quot;slug&quot;:&quot;feng-zi-23-49&quot;,&quot;isFollowed&quot;:false,&quot;description&quot;:&quot;&quot;,&quot;name&quot;:&quot;枫子&quot;,&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Ffeng-zi-23-49&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;da8e974dc&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic4.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false},{&quot;bio&quot;:&quot;Good Day.&quot;,&quot;isFollowing&quot;:false,&quot;hash&quot;:&quot;e797f48964a93f480b69d75cbd14b845&quot;,&quot;uid&quot;:685253998001524700,&quot;isOrg&quot;:false,&quot;slug&quot;:&quot;porphyah&quot;,&quot;isFollowed&quot;:false,&quot;description&quot;:&quot;Working in Progress...&quot;,&quot;name&quot;:&quot;Porphyah&quot;,&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fporphyah&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;v2-0010658e5fc4b6c50ca66ccbca52c0b8&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic4.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false}],&quot;summary&quot;:&quot;\u003Cimg src=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f98c82c10b472a4a8cfc307d08fa353_200x112.jpg\&quot; data-caption=\&quot;调试光线和最近交点法线\&quot; data-size=\&quot;normal\&quot; data-rawwidth=\&quot;1031\&quot; data-rawheight=\&quot;628\&quot; class=\&quot;origin_image inline-img zh-lightbox-thumb\&quot; data-original=\&quot;https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f98c82c10b472a4a8cfc307d08fa353_r.jpg\&quot;\u003E在上篇文章的基础上，做了许多调整，修复了许多BUG。在解决bug的过程中，我逐渐领悟到一个要领：枯燥地一步步调试太痛苦了，找不到问题的根源！所以我选择将中间结果打到图片上。如：（注意，里面的点是我随便点的，有互动了吧）这就非常爽了！ 本文分两个…&quot;,&quot;reviewingCommentsCount&quot;:0,&quot;meta&quot;:{&quot;previous&quot;:null,&quot;next&quot;:null},&quot;annotationDetail&quot;:null,&quot;commentsCount&quot;:1,&quot;likesCount&quot;:5,&quot;FULLINFO&quot;:true}},&quot;User&quot;:{&quot;bajdcc&quot;:{&quot;isFollowed&quot;:false,&quot;name&quot;:&quot;陈安&quot;,&quot;headline&quot;:&quot;发现编程的乐趣 https:\u002F\u002Fgithub.com\u002Fbajdcc&quot;,&quot;avatarUrl&quot;:&quot;https:\u002F\u002Fpic1.zhimg.com\u002Fv2-cd6d61ad9ef94c41b9e77f8e0f727893_s.jpg&quot;,&quot;isFollowing&quot;:false,&quot;type&quot;:&quot;people&quot;,&quot;slug&quot;:&quot;bajdcc&quot;,&quot;bio&quot;:&quot;专业研究野生技术&quot;,&quot;hash&quot;:&quot;7a228f3d98a5d011f952110c10dc4976&quot;,&quot;uid&quot;:71809588264960,&quot;isOrg&quot;:false,&quot;description&quot;:&quot;发现编程的乐趣 https:\u002F\u002Fgithub.com\u002Fbajdcc&quot;,&quot;badge&quot;:{&quot;identity&quot;:null,&quot;bestAnswerer&quot;:null},&quot;profileUrl&quot;:&quot;https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fbajdcc&quot;,&quot;avatar&quot;:{&quot;id&quot;:&quot;v2-cd6d61ad9ef94c41b9e77f8e0f727893&quot;,&quot;template&quot;:&quot;https:\u002F\u002Fpic1.zhimg.com\u002F{id}_{size}.jpg&quot;},&quot;isOrgWhiteList&quot;:false,&quot;isBanned&quot;:false}},&quot;Comment&quot;:{},&quot;favlists&quot;:{}},&quot;me&quot;:{},&quot;global&quot;:{&quot;experimentFeatures&quot;:{&quot;ge3&quot;:&quot;ge3_9&quot;,&quot;ge2&quot;:&quot;ge2_1&quot;,&quot;nwebStickySidebar&quot;:&quot;sticky&quot;,&quot;searchSectionStyle&quot;:&quot;loosen&quot;,&quot;androidPassThroughPush&quot;:&quot;leancloud&quot;,&quot;newMore&quot;:&quot;new&quot;,&quot;nwebQAGrowth&quot;:&quot;experiment&quot;,&quot;nwebFeedAd&quot;:&quot;experiment&quot;,&quot;newSign&quot;:&quot;newVersion&quot;,&quot;liveReviewBuyBar&quot;:&quot;live_review_buy_bar_2&quot;,&quot;qawebRelatedReadingsContentControl&quot;:&quot;open&quot;,&quot;marketTabBanner&quot;:&quot;market_tab_banner_not_show&quot;,&quot;liveStore&quot;:&quot;ls_a2_b2_c1_f2&quot;,&quot;qawebThumbnailAbtest&quot;:&quot;new&quot;,&quot;nwebSearch&quot;:&quot;nweb_search_heifetz&quot;,&quot;searchHybridTabs&quot;:&quot;without-tabs&quot;,&quot;enableVoteDownReasonMenu&quot;:&quot;enable&quot;,&quot;showVideoUploadAttention&quot;:&quot;true&quot;,&quot;isOffice&quot;:&quot;false&quot;,&quot;enableTtsPlay&quot;:&quot;false&quot;,&quot;wechatShareModal&quot;:&quot;wechat_share_modal_show&quot;,&quot;newLiveFeedMediacard&quot;:&quot;old&quot;,&quot;hybridZhmoreVideo&quot;:&quot;no&quot;,&quot;recommendationAbtest&quot;:&quot;new&quot;,&quot;qrcodeLogin&quot;:&quot;qrcode&quot;,&quot;isShowUnicomFreeEntry&quot;:&quot;unicom_free_entry_off&quot;,&quot;newMobileColumnAppheader&quot;:&quot;new_header&quot;,&quot;androidDbCommentWithRepinRecord&quot;:&quot;open&quot;,&quot;androidDbRecommendAction&quot;:&quot;open&quot;,&quot;zcmLighting&quot;:&quot;zcm&quot;,&quot;androidDbFeedHashTagStyle&quot;:&quot;button&quot;,&quot;appStoreRateDialog&quot;:&quot;close&quot;,&quot;mobileQaPageProxyHeifetz&quot;:&quot;m_qa_page_nweb&quot;,&quot;newAppViewRelatedAd&quot;:&quot;no&quot;,&quot;default&quot;:&quot;None&quot;,&quot;isNewNotiPanel&quot;:&quot;yes&quot;,&quot;androidDbRepinSelection&quot;:&quot;open&quot;,&quot;nwebRelatedAdvert&quot;:&quot;default&quot;,&quot;qaStickySidebar&quot;:&quot;sticky_sidebar&quot;,&quot;androidProfilePanel&quot;:&quot;panel_b&quot;,&quot;nwebWriteAnswer&quot;:&quot;experiment&quot;}},&quot;columns&quot;:{&quot;next&quot;:{}},&quot;columnPosts&quot;:{},&quot;columnSettings&quot;:{&quot;colomnAuthor&quot;:[],&quot;uploadAvatarDetails&quot;:&quot;&quot;,&quot;contributeRequests&quot;:[],&quot;contributeRequestsTotalCount&quot;:0,&quot;inviteAuthor&quot;:&quot;&quot;},&quot;postComments&quot;:{},&quot;postReviewComments&quot;:{&quot;comments&quot;:[],&quot;newComments&quot;:[],&quot;hasMore&quot;:true},&quot;favlistsByUser&quot;:{},&quot;favlistRelations&quot;:{},&quot;promotions&quot;:{},&quot;switches&quot;:{&quot;couldSetPoster&quot;:false},&quot;draft&quot;:{&quot;titleImage&quot;:&quot;&quot;,&quot;titleImageSize&quot;:{},&quot;isTitleImageFullScreen&quot;:false,&quot;canTitleImageFullScreen&quot;:false,&quot;title&quot;:&quot;&quot;,&quot;titleImageUploading&quot;:false,&quot;error&quot;:&quot;&quot;,&quot;content&quot;:&quot;&quot;,&quot;draftLoading&quot;:false,&quot;globalLoading&quot;:false,&quot;pendingVideo&quot;:{&quot;resource&quot;:null,&quot;error&quot;:null}},&quot;drafts&quot;:{&quot;draftsList&quot;:[],&quot;next&quot;:{}},&quot;config&quot;:{&quot;userNotBindPhoneTipString&quot;:{}},&quot;recommendPosts&quot;:{&quot;articleRecommendations&quot;:[],&quot;columnRecommendations&quot;:[]},&quot;env&quot;:{&quot;edition&quot;:{&quot;baidu&quot;:false,&quot;yidianzixun&quot;:false,&quot;qqnews&quot;:false},&quot;isAppView&quot;:false,&quot;appViewConfig&quot;:{&quot;content_padding_top&quot;:128,&quot;content_padding_bottom&quot;:56,&quot;content_padding_left&quot;:16,&quot;content_padding_right&quot;:16,&quot;title_font_size&quot;:22,&quot;body_font_size&quot;:16,&quot;is_dark_theme&quot;:false,&quot;can_auto_load_image&quot;:true,&quot;app_info&quot;:&quot;OS=iOS&quot;},&quot;isApp&quot;:false,&quot;userAgent&quot;:{&quot;ua&quot;:&quot;Wget\u002F1.19.1 (cygwin)&quot;,&quot;browser&quot;:{},&quot;engine&quot;:{},&quot;os&quot;:{},&quot;device&quot;:{},&quot;cpu&quot;:{}}},&quot;message&quot;:{&quot;newCount&quot;:0},&quot;pushNotification&quot;:{&quot;newCount&quot;:0}}</textarea><script src="//static.zhihu.com/hemingway/common.dbe216922984b85d39c4.js"></script><script src="//static.zhihu.com/hemingway/app.eecd17b317c2f4ce2f56.js"></script><script src="//static.zhihu.com/hemingway/raven.bdd8772ab8ba1205b8ea.js" async="" defer=""></script></body></html>